# LLM Lite å¯¹æ¥æŒ‡å—

## ğŸ“‹ ç›®å½•
1. [å½“å‰æ¶æ„åˆ†æ](#å½“å‰æ¶æ„åˆ†æ)
2. [LLM Lite å¯¹æ¥æ–¹æ¡ˆ](#llm-lite-å¯¹æ¥æ–¹æ¡ˆ)
3. [éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶](#éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶)
4. [é…ç½®æ­¥éª¤](#é…ç½®æ­¥éª¤)
5. [æµ‹è¯•éªŒè¯](#æµ‹è¯•éªŒè¯)
6. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## å½“å‰æ¶æ„åˆ†æ

### ç°æœ‰ API è°ƒç”¨æµç¨‹

```
æµè§ˆå™¨æ‰©å±• (App.tsx)
    â†“
useAI Hook (useAI.ts)
    â†“
AI Service (ai.ts)
    â†“ [æ ¹æ® apiMode é€‰æ‹©]
    â”œâ”€ Internal Mode â†’ INTERNAL_API_CONFIG[provider]
    â””â”€ DIY Mode â†’ settings.baseUrl + settings.apiKey
    â†“
ç›´æ¥è°ƒç”¨å„ä¾›åº”å•† API (OpenAI/Gemini/Doubaoç­‰)
```

### å…³é”®é…ç½®ä½ç½®

#### 1. **Settings ç±»å‹å®šä¹‰** (`src/types/index.ts`)
```typescript
export interface Settings {
  apiMode: 'internal' | 'diy';  // APIæ¨¡å¼
  baseUrl: string;               // DIYæ¨¡å¼çš„APIåœ°å€
  apiKey: string;                // DIYæ¨¡å¼çš„APIå¯†é’¥
  provider: string;              // ä¾›åº”å•† (doubao/gpt/geminiç­‰)
  model: string;                 // æ¨¡å‹åç§°
  // ... å…¶ä»–é…ç½®
}
```

#### 2. **AI Service** (`src/services/ai.ts`)
- **æ–‡æœ¬ç”Ÿæˆ**: `sendToAI()` - ç¬¬105è¡Œå†³å®šä½¿ç”¨å“ªä¸ªbaseUrl
- **è§†é¢‘ç”Ÿæˆ**: `generateVideo()` - ç¬¬760è¡Œå†³å®šä½¿ç”¨å“ªä¸ªbaseUrl
- **è§†é¢‘è½®è¯¢**: `pollVideoTask()` - ç¬¬1258è¡Œå†³å®šä½¿ç”¨å“ªä¸ªbaseUrl

---

## LLM Lite å¯¹æ¥æ–¹æ¡ˆ

### æ–¹æ¡ˆæ¦‚è¿°

**å¥½æ¶ˆæ¯**ï¼šå½“å‰æ¶æ„å·²ç»ä¸º LLM Lite å¯¹æ¥åšå¥½äº†å‡†å¤‡ï¼åªéœ€è¦é…ç½®ï¼Œ**æ— éœ€ä¿®æ”¹ä»£ç **ã€‚

```
æµè§ˆå™¨æ‰©å±• (App.tsx)
    â†“
useAI Hook (useAI.ts)
    â†“
AI Service (ai.ts)
    â†“ [DIY Mode]
settings.baseUrl = "https://your-llm-lite-server.com/v1"
settings.apiKey = "your-llm-lite-api-key"
    â†“
LLM Lite ä¸­è½¬æœåŠ¡å™¨
    â†“ [ç»•è¿‡ CORS]
å„ä¾›åº”å•† API (OpenAI/Gemini/Doubao/Soraç­‰)
```

### ä¸ºä»€ä¹ˆç°æœ‰æ¶æ„å·²ç»æ”¯æŒï¼Ÿ

1. âœ… **DIY æ¨¡å¼å·²å­˜åœ¨** - ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰ `baseUrl` å’Œ `apiKey`
2. âœ… **ç»Ÿä¸€æ¥å£æ ¼å¼** - æ‰€æœ‰è¯·æ±‚éƒ½ä½¿ç”¨ OpenAI å…¼å®¹æ ¼å¼
3. âœ… **è§†é¢‘ API å·²é›†æˆ** - `generateVideo()` å’Œ `pollVideoTask()` éƒ½æ”¯æŒè‡ªå®šä¹‰ baseUrl
4. âœ… **è®¾ç½®ç•Œé¢å·²å®Œæˆ** - UI ä¸­å·²æœ‰ baseUrl å’Œ apiKey è¾“å…¥æ¡†

---

## éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶

### âš ï¸ é‡è¦ï¼šå®é™…ä¸Š**ä¸éœ€è¦ä¿®æ”¹ä»»ä½•ä»£ç **ï¼

åªéœ€è¦åœ¨ **LLM Lite æœåŠ¡å™¨ç«¯**å®ç°ä»¥ä¸‹æ¥å£ï¼š

### LLM Lite æœåŠ¡å™¨éœ€è¦å®ç°çš„æ¥å£

#### 1. **æ–‡æœ¬ç”Ÿæˆæ¥å£** (OpenAI å…¼å®¹)
```
POST https://your-llm-lite-server.com/v1/chat/completions

Headers:
  Authorization: Bearer {apiKey}
  Content-Type: application/json

Body:
{
  "model": "gpt-4o",  // æˆ–å…¶ä»–æ¨¡å‹
  "messages": [
    { "role": "system", "content": "..." },
    { "role": "user", "content": "..." }
  ],
  "temperature": 0.7,
  "stream": false
}

Response:
{
  "choices": [{
    "message": {
      "role": "assistant",
      "content": "ç”Ÿæˆçš„å†…å®¹..."
    }
  }]
}
```

#### 2. **è§†é¢‘ç”Ÿæˆæ¥å£** (éœ€è¦å®ç°)
```
POST https://your-llm-lite-server.com/v1/chat/completions

Headers:
  Authorization: Bearer {apiKey}
  Content-Type: application/json

Body:
{
  "model": "sora-2",  // è§†é¢‘æ¨¡å‹
  "messages": [
    { "role": "system", "content": "è§†é¢‘ç”Ÿæˆç³»ç»Ÿæç¤ºè¯" },
    { "role": "user", "content": "äº§å“æè¿°" }
  ],
  "video_config": {
    "duration": 5,
    "width": 1920,
    "height": 1080,
    // ... å…¶ä»–è§†é¢‘é…ç½®
  }
}

Response (å¼‚æ­¥ä»»åŠ¡):
{
  "task_id": "video-task-12345",
  "status": "pending",
  "prompt": "ç”Ÿæˆçš„è§†é¢‘æç¤ºè¯"
}
```

#### 3. **è§†é¢‘è½®è¯¢æ¥å£** (éœ€è¦å®ç°)
```
GET https://your-llm-lite-server.com/v1/tasks/{task_id}

Headers:
  Authorization: Bearer {apiKey}

Response (è¿›è¡Œä¸­):
{
  "status": "processing",
  "progress": 45
}

Response (å®Œæˆ):
{
  "status": "completed",
  "video_url": "https://cdn.example.com/video.mp4",
  "prompt": "è§†é¢‘æç¤ºè¯"
}

Response (å¤±è´¥):
{
  "status": "failed",
  "error": "é”™è¯¯ä¿¡æ¯"
}
```

---

## é…ç½®æ­¥éª¤

### æ­¥éª¤ 1: éƒ¨ç½² LLM Lite æœåŠ¡å™¨

ç¡®ä¿æ‚¨çš„ LLM Lite æœåŠ¡å™¨ï¼š
1. âœ… å®ç°äº†ä¸Šè¿°ä¸‰ä¸ªæ¥å£
2. âœ… é…ç½®äº† CORS å…è®¸æµè§ˆå™¨æ‰©å±•è®¿é—®
3. âœ… æ”¯æŒ OpenAI å…¼å®¹çš„ API æ ¼å¼
4. âœ… èƒ½å¤Ÿè½¬å‘è¯·æ±‚åˆ°å„ä¸ªä¾›åº”å•† API

### æ­¥éª¤ 2: åœ¨æ‰©å±•ä¸­é…ç½® LLM Lite

ç”¨æˆ·åœ¨ä½¿ç”¨æ‰©å±•æ—¶ï¼Œéœ€è¦ï¼š

1. **æ‰“å¼€è®¾ç½®å¼¹çª—**ï¼ˆç‚¹å‡»å³ä¸Šè§’è®¾ç½®å›¾æ ‡ï¼‰

2. **åˆ‡æ¢åˆ° DIY æ¨¡å¼**
   - åœ¨è®¾ç½®ç•Œé¢é¡¶éƒ¨ï¼Œåˆ‡æ¢ API æ¨¡å¼ä¸º "DIY Mode"

3. **é…ç½® LLM Lite åœ°å€**
   ```
   Base URL: https://your-llm-lite-server.com/v1
   API Key: your-llm-lite-api-key
   ```

4. **é€‰æ‹©ä¾›åº”å•†å’Œæ¨¡å‹**
   ```
   Provider: gpt (æˆ–å…¶ä»–)
   Model: gpt-4o (æˆ–å…¶ä»–)
   ```

5. **ä¿å­˜é…ç½®**

### æ­¥éª¤ 3: æµ‹è¯•è¿æ¥

1. åœ¨è®¾ç½®ç•Œé¢ç‚¹å‡» **"ç«‹å³æ‰«æ"** æŒ‰é’®
2. ç³»ç»Ÿä¼šæµ‹è¯•æ‰€æœ‰ä¾›åº”å•†çš„è¿é€šæ€§
3. ç¡®è®¤ LLM Lite è¿”å›æ­£ç¡®çš„å“åº”

---

## æµ‹è¯•éªŒè¯

### æ–‡æœ¬ç”Ÿæˆæµ‹è¯•

1. é€‰æ‹©ä¸€ä¸ªäº§å“
2. è¿›å…¥æ­¥éª¤ 2 æ ¡å¯¹å†…å®¹
3. è¿›å…¥æ­¥éª¤ 3 é…ç½®ç­–ç•¥
   - é€‰æ‹© "æ–‡æœ¬ç”Ÿæˆ" æ¨¡å¼
   - é€‰æ‹©ç›®æ ‡è¯­è¨€å’Œè¾“å‡ºæ ¼å¼
4. ç‚¹å‡» "ä¸‹ä¸€æ­¥" ç”Ÿæˆå†…å®¹
5. éªŒè¯ç”Ÿæˆçš„å†…å®¹æ˜¯å¦æ­£ç¡®

### è§†é¢‘ç”Ÿæˆæµ‹è¯•

1. é€‰æ‹©ä¸€ä¸ªäº§å“
2. è¿›å…¥æ­¥éª¤ 2 æ ¡å¯¹å†…å®¹
3. è¿›å…¥æ­¥éª¤ 3 é…ç½®ç­–ç•¥
   - é€‰æ‹© "è§†é¢‘ç”Ÿæˆ" æ¨¡å¼
   - é€‰æ‹©è§†é¢‘æ¨¡å‹ï¼ˆå¦‚ Sora 2ï¼‰
   - é€‰æ‹©è§†é¢‘é£æ ¼
4. ç‚¹å‡» "ä¸‹ä¸€æ­¥" ç”Ÿæˆè§†é¢‘
5. è§‚å¯Ÿè½®è¯¢è¿›åº¦
6. éªŒè¯è§†é¢‘æ˜¯å¦ç”ŸæˆæˆåŠŸ

---

## å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆè§†é¢‘ç”Ÿæˆéœ€è¦ LLM Liteï¼Ÿ

**A**: è§†é¢‘æ¨¡å‹çš„åŸç”Ÿ APIï¼ˆå¦‚ Google Veoï¼‰ç¦æ­¢æµè§ˆå™¨ç›´æ¥è°ƒç”¨ï¼ˆCORS é™åˆ¶ï¼‰ã€‚LLM Lite ä½œä¸ºä¸­è½¬æœåŠ¡å™¨å¯ä»¥ï¼š
- âœ… ç»•è¿‡æµè§ˆå™¨çš„ CORS é™åˆ¶
- âœ… ç»Ÿä¸€ç®¡ç† API å¯†é’¥ï¼ˆæ›´å®‰å…¨ï¼‰
- âœ… å®ç°è¯·æ±‚é™æµå’Œé…é¢ç®¡ç†
- âœ… æä¾›ç»Ÿä¸€çš„é”™è¯¯å¤„ç†

### Q2: æ–‡æœ¬ç”Ÿæˆä¹Ÿéœ€è¦ LLM Lite å—ï¼Ÿ

**A**: ä¸ä¸€å®šã€‚æ–‡æœ¬æ¨¡å‹ï¼ˆGPT/Gemini/Claudeç­‰ï¼‰é€šå¸¸æä¾›äº† CORS å‹å¥½çš„æ¥å£ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨ã€‚ä½†ä½¿ç”¨ LLM Lite æœ‰ä»¥ä¸‹å¥½å¤„ï¼š
- âœ… ç»Ÿä¸€ç®¡ç†æ‰€æœ‰ API
- âœ… æ›´å¥½çš„å®‰å…¨æ€§ï¼ˆAPI å¯†é’¥ä¸æš´éœ²åœ¨å‰ç«¯ï¼‰
- âœ… ç»Ÿä¸€çš„æ—¥å¿—å’Œç›‘æ§
- âœ… æ›´çµæ´»çš„é…é¢å’Œè®¡è´¹ç®¡ç†

### Q3: å¦‚ä½•å¤„ç† API å¯†é’¥å®‰å…¨é—®é¢˜ï¼Ÿ

**A**: 
- **Internal Mode**: API å¯†é’¥å­˜å‚¨åœ¨ç¯å¢ƒå˜é‡ä¸­ï¼Œä¸æš´éœ²ç»™ç”¨æˆ·
- **DIY Mode**: ç”¨æˆ·è‡ªå·±æä¾› LLM Lite çš„ API Keyï¼Œå­˜å‚¨åœ¨æœ¬åœ° Chrome Storage
- **æ¨è**: ä¼ä¸šç”¨æˆ·ä½¿ç”¨ Internal Mode + LLM Liteï¼Œä¸ªäººç”¨æˆ·ä½¿ç”¨ DIY Mode

### Q4: LLM Lite éœ€è¦æ”¯æŒå“ªäº›æ¨¡å‹ï¼Ÿ

**A**: æ ¹æ® `src/types/index.ts` ä¸­çš„å®šä¹‰ï¼š

**æ–‡æœ¬æ¨¡å‹**:
- Doubao: `doubao-pro-32k`, `doubao-lite-32k` ç­‰
- GPT: `gpt-4o`, `gpt-4o-mini`, `o1`, `o1-mini` ç­‰
- Gemini: `gemini-2.0-flash-exp`, `gemini-1.5-pro` ç­‰
- Claude: `claude-3-5-sonnet-20241022` ç­‰
- Qwen: `qwen-max`, `qwen-plus` ç­‰

**è§†é¢‘æ¨¡å‹**:
- Sora: `sora-2`, `sora-2-pro`
- Doubao: `doubao-seedance-1.5-pro`
- Qwen: `qwen-wan-2.6`, `qwen-wan-2.5-preview` ç­‰

### Q5: å¦‚ä½•è°ƒè¯• LLM Lite å¯¹æ¥é—®é¢˜ï¼Ÿ

**A**: 
1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…· (F12)
2. æŸ¥çœ‹ Console æ ‡ç­¾é¡µçš„æ—¥å¿—
3. å…³é”®æ—¥å¿—æ ‡è¯†ï¼š
   - `[AI Service]` - AI æœåŠ¡è°ƒç”¨æ—¥å¿—
   - `[Video API]` - è§†é¢‘ API è°ƒç”¨æ—¥å¿—
   - `[Polling]` - è§†é¢‘è½®è¯¢æ—¥å¿—
4. æ£€æŸ¥ Network æ ‡ç­¾é¡µçš„è¯·æ±‚è¯¦æƒ…

---

## ä»£ç å‚è€ƒ

### å¦‚æœéœ€è¦è‡ªå®šä¹‰ LLM Lite è·¯ç”±

è™½ç„¶ä¸éœ€è¦ä¿®æ”¹å‰ç«¯ä»£ç ï¼Œä½†å¦‚æœæ‚¨çš„ LLM Lite ä½¿ç”¨ä¸åŒçš„è·¯ç”±ï¼Œå¯ä»¥ä¿®æ”¹ï¼š

**æ–‡ä»¶**: `src/services/ai.ts`

**æ–‡æœ¬ç”Ÿæˆ API è·¯ç”±** (ç¬¬380è¡Œ):
```typescript
let apiUrl = `${baseUrl}/chat/completions`;  // æ”¹ä¸ºæ‚¨çš„è·¯ç”±
```

**è§†é¢‘ç”Ÿæˆ API è·¯ç”±** (ç¬¬1156è¡Œ):
```typescript
let apiUrl = `${baseUrl}/chat/completions`;  // æ”¹ä¸ºæ‚¨çš„è·¯ç”±
```

**è§†é¢‘è½®è¯¢ API è·¯ç”±** (ç¬¬1261è¡Œ):
```typescript
const apiUrl = `${baseUrl}/tasks/${taskId}`;  // æ”¹ä¸ºæ‚¨çš„è·¯ç”±
```

---

## æ€»ç»“

### âœ… ä¼˜åŠ¿

1. **æ— éœ€ä¿®æ”¹å‰ç«¯ä»£ç ** - å½“å‰æ¶æ„å·²å®Œç¾æ”¯æŒ
2. **é…ç½®ç®€å•** - åªéœ€åœ¨è®¾ç½®ä¸­å¡«å†™ LLM Lite åœ°å€å’Œå¯†é’¥
3. **ç»Ÿä¸€ç®¡ç†** - æ‰€æœ‰ API è°ƒç”¨éƒ½é€šè¿‡ LLM Lite ä¸­è½¬
4. **å®‰å…¨å¯é ** - API å¯†é’¥ä¸æš´éœ²åœ¨å‰ç«¯
5. **çµæ´»æ‰©å±•** - å¯ä»¥éšæ—¶æ·»åŠ æ–°çš„æ¨¡å‹å’Œä¾›åº”å•†

### ğŸ“ å¾…åŠäº‹é¡¹

**LLM Lite æœåŠ¡å™¨ç«¯**:
- [ ] å®ç° `/v1/chat/completions` æ¥å£ï¼ˆæ–‡æœ¬å’Œè§†é¢‘ï¼‰
- [ ] å®ç° `/v1/tasks/{task_id}` æ¥å£ï¼ˆè§†é¢‘è½®è¯¢ï¼‰
- [ ] é…ç½® CORS å…è®¸æµè§ˆå™¨æ‰©å±•è®¿é—®
- [ ] å®ç° API å¯†é’¥éªŒè¯å’Œé…é¢ç®¡ç†
- [ ] æ·»åŠ æ—¥å¿—å’Œç›‘æ§

**å‰ç«¯é…ç½®**:
- [ ] åœ¨è®¾ç½®ä¸­é…ç½® LLM Lite åœ°å€
- [ ] æµ‹è¯•æ–‡æœ¬ç”ŸæˆåŠŸèƒ½
- [ ] æµ‹è¯•è§†é¢‘ç”ŸæˆåŠŸèƒ½
- [ ] éªŒè¯æ‰€æœ‰ä¾›åº”å•†å’Œæ¨¡å‹

---

## è”ç³»æ”¯æŒ

å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
- å‰ç«¯æ—¥å¿—: æµè§ˆå™¨å¼€å‘è€…å·¥å…· Console
- åç«¯æ—¥å¿—: LLM Lite æœåŠ¡å™¨æ—¥å¿—
- API æ–‡æ¡£: å‚è€ƒ OpenAI API è§„èŒƒ

ç¥å¯¹æ¥é¡ºåˆ©ï¼ğŸš€
